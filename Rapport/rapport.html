<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Analyse des fichiers</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">Analyse des fichiers</h1>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#exercice-1">Exercice 1</a></li>
<li><a href="#exercice-2">Exercice 2</a></li>
<li><a href="#exercice-3">Exercice 3</a></li>
<li><a href="#exercice-4">Exercice 4</a></li>
</ul>
</nav>
<section id="exercice-1" class="level1">
<h1>Exercice 1</h1>
<section id="combien-y-a-t-til-de-lignes-dans-chaque-fichier" class="level2">
<h2>Combien y-a-t-til de lignes dans chaque fichier ?</h2>
<pre><code>wc -l file</code></pre>
<p><strong>athlete_events.csv</strong> : 271 117 lignes. <strong>noc_regions</strong> : 230 lignes.</p>
</section>
<section id="afficher-uniquement-la-première-ligne-du-fichier-athlète" class="level2">
<h2>Afficher uniquement la première ligne du fichier athlète</h2>
<pre><code>head -1 athlete_events.csv</code></pre>
<p>“ID”,“Name”,“Sex”,“Age”,“Height”,“Weight”,“Team”,“NOC”,“Games”,“Year”,“Season”,“City”,“Sport”,“Event”,“Medal”</p>
</section>
<section id="quel-est-le-séparateur-de-champs" class="level2">
<h2>Quel est le séparateur de champs ?</h2>
<p>Le séparateur de champs est la virgule.</p>
</section>
<section id="que-représente-une-ligne" class="level2">
<h2>Que représente une ligne ?</h2>
<p>Une ligne représente une participation d’un athlète à une compétition.</p>
</section>
<section id="combien-y-a-t-il-de-colonnes" class="level2">
<h2>Combien y-a-t-il de colonnes ?</h2>
<pre><code>head -1 athlete_events.csv |tr &quot; &quot; _ |tr , &quot; &quot; |wc -w</code></pre>
<p>Il y a 15 colonnes.</p>
</section>
<section id="quelle-colonne-distingue-les-jeux-dété-et-dhivers" class="level2">
<h2>Quelle colonne distingue les jeux d’été et d’hivers ?</h2>
<p>La colonne <strong>Season</strong>.</p>
</section>
<section id="combien-de-lignes-font-référence-à-jean-claude-killy" class="level2">
<h2>Combien de lignes font référence à Jean-Claude Killy ?</h2>
<pre><code>cat athlete_events.csv |grep &quot;Jean-Claude Killy&quot; |wc -l</code></pre>
<p>Il y a 6 lignes qui font références à Jean-Claude Killy.</p>
</section>
<section id="quel-encodage-est-utilisé-pour-ce-fichier" class="level2">
<h2>Quel encodage est utilisé pour ce fichier ?</h2>
<pre><code>file -b -i  athlete_events.csv</code></pre>
<p>Ce fichier est encodé en <strong>us-ascii</strong>.</p>
</section>
<section id="comment-envisagez-vous-limport-de-ces-données" class="level2">
<h2>Comment envisagez-vous l’import de ces données ?</h2>
<ul>
<li>Convertir de fichier en utf-8</li>
</ul>
<pre><code>iconv -f us-ascii  -t utf-8 athlete_events.csv &gt; athlete_events_utf8.csv</code></pre>
<ul>
<li>Importer les données import from ‘athlete_events_utf8.csv’ with (FORMAT csv, NULL ‘NA’, HEADER, ENCODING ‘UTF-8’)</li>
</ul>
<section id="colonne-de-la-table-import" class="level3">
<h3>Colonne de la table import</h3>
<p><strong>athlete_events_utf8.csv</strong> n1 = INT n2 = TEXT -&gt; CHAR(108) : SELECT MAX(LENGTH(n2)) FROM import; n3 = TEXT -&gt; CHAR(1) : SELECT MAX(LENGTH(n3)) FROM import; n4 = INT n5 = INT n6 = FLOAT n7 = TEXT -&gt; CHAR(47) : SELECT MAX(LENGTH(n7)) FROM import; n8 = TEXT -&gt; CHAR(3) : SELECT MAX(LENGTH(n8)) FROM import; n9 = TEXT -&gt; CHAR(11) : SELECT MAX(LENGTH(n9)) FROM import; n10 = INT n11 = TEXT -&gt; CHAR(6) : SELECT MAX(LENGTH(n11)) FROM import; n12 = TEXT -&gt; CHAR(22) : SELECT MAX(LENGTH(n12)) FROM import; n13 = TEXT -&gt; CHAR(25) : SELECT MAX(LENGTH(n13)) FROM import; n14 = TEXT -&gt; CHAR(85) : SELECT MAX(LENGTH(n14)) FROM import; n15 = TEXT -&gt; CHAR(6) : SELECT MAX(LENGTH(n15)) FROM import;</p>
<p><strong>noc_regions_utf8.csv</strong> n16 = TEXT -&gt; CHAR(3) : SELECT MAX(LENGTH(n16)) FROM import; n17 = TEXT -&gt; CHAR(32) : SELECT MAX(LENGTH(n17)) FROM import n18 = TEXT -&gt; CHAR(27) : SELECT MAX(LENGTH(n18)) FROM import</p>
</section>
</section>
</section>
<section id="exercice-2" class="level1">
<h1>Exercice 2</h1>
<p>Voici la partie du script qui permet d’importer les données, elle est trouvable dans le script “importation.sql”, et représente les 28 premières lignes de ce script. Ce script est idempotent, il produit toujours le même résultat.</p>
<pre><code>DROP TABLE IF EXISTS import CASCADE;
DROP TABLE IF EXISTS noc;
DROP TABLE IF EXISTS athlete CASCADE;
DROP TABLE IF EXISTS regions CASCADE;
DROP TABLE IF EXISTS olympics CASCADE;
DROP TABLE IF EXISTS epreuves CASCADE;
DROP TABLE IF EXISTS participe;
DROP TABLE IF EXISTS resultat;
DROP TABLE IF EXISTS contient;

CREATE temp TABLE import (
    n1 INT, n2 TEXT, n3 TEXT, n4 INT, n5 INT, n6 FLOAT,
    n7 TEXT, n8 TEXT, n9 TEXT, n10 INT, n11 TEXT, n12 TEXT,
    n13 TEXT, n14 TEXT, n15 TEXT
    );
    
\copy import from &#39;Ressource/athlete_events_utf8.csv&#39; with (FORMAT csv, NULL &#39;NA&#39;, HEADER, ENCODING &#39;UTF-8&#39;)

DELETE FROM import WHERE n10 &lt; 1920 OR n13 = &#39;Art Competitions&#39;;

-- SELECT COUNT(*) FROM import; -&gt; 255.080

CREATE temp TABLE noc (
    n1 TEXT, n2 TEXT, n3 TEXT
    );</code></pre>
</section>
<section id="exercice-3" class="level1">
<h1>Exercice 3</h1>
<p>Toutes les requêtes sont trouvable dans le fichier “requetes.sql” en pièce jointe</p>
<section id="combien-de-colonnes-dans-import-1-valeur" class="level2">
<h2>Combien de colonnes dans import ? (1 valeur)</h2>
<p>SELECT COUNT(*) AS nbcolumns FROM information_schema.columns WHERE table_name = ‘import’;</p>
</section>
<section id="combien-de-lignes-dans-import-1-valeur" class="level2">
<h2>Combien de lignes dans import ? (1 valeur)</h2>
<p>SELECT COUNT(*) AS nbrows FROM import;</p>
</section>
<section id="combien-de-codes-noc-dans-noc-1-valeur" class="level2">
<h2>Combien de codes NOC dans noc ? (1 valeur)</h2>
<p>SELECT COUNT(n1) FROM noc;</p>
</section>
<section id="combien-dathletes-différents-sont-référencés-dans-ce-fichier-1-valeur" class="level2">
<h2>Combien d’athletes différents sont référencés dans ce fichier (1 valeur)</h2>
<p>SELECT COUNT(DISTINCT n2) FROM import;</p>
</section>
<section id="combien-y-a-t-il-de-médailles-dor-dans-ce-fichier-1-valeur" class="level2">
<h2>Combien y-a t-il de médailles d’or dans ce fichier ?(1 valeur)</h2>
<p>SELECT COUNT(n15) FROM import WHERE n15=‘Gold’; ## Retrouvez Carl Lewis; Combien de lignes se réfèrent à Carl Lewis ? (1 valeur) SELECT * FROM import WHERE n2 LIKE ‘Carl Lewis%’;</p>
</section>
</section>
<section id="exercice-4" class="level1">
<h1>Exercice 4</h1>
<section id="mcd" class="level2">
<h2>MCD</h2>
<p>Les fichiers mcd et mld sont dans le dossier en pièce jointe, comme le reste, mais voici une image du MCD extrait directement de Olympics.mcd :<br />
<img src="image/MCD.png" alt="Olympics MCD" /></p>
</section>
<section id="mld" class="level2">
<h2>MLD</h2>
<p>De la même manière, voici un extrait d’Olympics.mld : <img src="image/MLD.png" alt="Olympics MLD" /> # Exercice 5</p>
</section>
</section>
</body>
</html>
